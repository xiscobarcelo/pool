<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torneos</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    
    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@400;500;700&display=swap" rel="stylesheet">

	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/styles-common.css">
    <link rel="stylesheet" href="css/styles-tournaments.css">
    <link rel="stylesheet" href="css/styles-registro.css">
	<link rel="stylesheet" href="css/bottom-nav.css">
	<link rel="stylesheet" href="css/comparativa_torneos.css">
    
    <!-- Chart.js para gr√°ficos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <!-- Verificar sesi√≥n -->
    <script>
        if (!sessionStorage.getItem('xisco_session_active')) {
            window.location.href = 'index.html';
        }
    </script>
</head>
<body>
    
 <div class="container">


   <!-- Header -->
<div class="page-header">
    <div class="header-content-wrapper">
        <div class="header-text">
            <h1>An√°lisis</h1>
            <p>Gr√°ficas comparativas de rendiento en torneos</p>
        </div>
        <div class="header-image">
            <img src="/pool/images/banner.png" alt="Xisco">
        </div>
    </div>
</div>
        <!-- Secci√≥n de Exportaci√≥n y Sincronizaci√≥n -->
        <div class="analytics-section">
          <div class="section-header" id="analisis">
         
          </div>
          <div class="charts-grid">
            <!-- Gr√°fico: Resultados por A√±o -->
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">Resultados por A√±o</h3>
                <p class="chart-description">Evoluci√≥n de tus logros en el tiempo</p>
              </div>
              <div class="chart-container2">
                <canvas id="yearResultsChart"></canvas>
              </div>
            </div>
            <!-- Gr√°fico: Rendimiento por Material -->
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">Rendimiento por Taco</h3>
                <p class="chart-description">¬øQu√© material te da mejores resultados?</p>
              </div>
              <div class="chart-container2">
                <canvas id="materialPerformanceChart"></canvas>
              </div>
            </div>
            <!-- Gr√°fico: Evoluci√≥n Temporal -->
            <div class="chart-card chart-card-wide">
              <div class="chart-header">
                <h3 class="chart-title">Evoluci√≥n Temporal</h3>
                <p class="chart-description">L√≠nea de tiempo de tus torneos</p>
              </div>
              <div class="chart-container1">
                <canvas id="timelineChart"></canvas>
              </div>
            </div>
          </div>
        </div>
	 
<div class="card">
    <div class="card-header">
        <h2>Comparativa de Circuitos</h2>

    </div>
    
    <div class="card-body">
        <!-- Selector de circuitos -->
        <div class="circuit-selector-container">
            <div class="selector-header">
                <span class="selector-label">Selecciona circuitos para comparar:</span>
                <button class="btn-secondary btn-small" onclick="selectAllCircuits()">
                    Seleccionar todos
                </button>
                <button class="btn-secondary btn-small" onclick="clearCircuitSelection()">
                    Limpiar selecci√≥n
                </button>
            </div>
            
            <div id="circuitCheckboxes" class="circuit-checkboxes">
                <!-- Se llenar√° din√°micamente con JavaScript -->
            </div>
            
            <div class="no-circuits" id="noCircuitsMessage" style="display: none;">
                <p>‚ö†Ô∏è No hay circuitos para comparar. A√±ade circuitos a tus torneos primero.</p>
            </div>
        </div>
        
        <!-- Selector de m√©trica -->
        <div class="metric-selector">
            <label for="comparisonMetric">Comparar por:</label>
            <select id="comparisonMetric" onchange="updateCircuitComparison()">
                <option value="tournaments">N√∫mero de torneos</option>
                <option value="winRate">Tasa de victoria (%)</option>
                <option value="avgPosition">Posici√≥n promedio</option>
                <option value="totalMatches">Total de partidas</option>
                <option value="totalWins">Total de victorias</option>
            </select>
        </div>
        
        <!-- Gr√°fica -->
        <div class="chart-card">
            <canvas id="circuitComparisonChart"></canvas>
        </div>
        
        <!-- Tabla comparativa -->
        <div class="chart-card comparison-table-container">
            <h3>Detalles por circuito</h3>
            <div class="table-responsive">
                <table id="circuitComparisonTable" class="comparison-table">
                    <thead>
                        <tr>
                            <th>Circuito</th>
                            <th>Torneos</th>
                            <th>Victorias</th>
                            <th>% Victoria</th>
                            <th>Pos. Media</th>
                            <th>Mejor Pos.</th>
                            <th>√öltima participaci√≥n</th>
                        </tr>
                    </thead>
                    <tbody id="circuitComparisonTableBody">
                        <!-- Se llenar√° din√°micamente -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


		<!-- ============================================ -->
<!-- COMPARATIVA DE CIRCUITOS - VERSI√ìN CORREGIDA V2 -->
<!-- Con detecci√≥n mejorada de victorias y m√©tricas -->
<!-- ============================================ -->

<!-- Comparativa de Torneos -->
<section class="analysis-section tournament-comparison-wrapper">
    <div class="section-header-analysis">
        <div class="section-title-group">
            <h2 class="section-main-title">üìä Comparativa Hist√≥rica de Torneos</h2>
            <p class="section-subtitle-text">Analiza tu evoluci√≥n en el mismo torneo a trav√©s de los a√±os</p>
        </div>
    </div>

    <div class="tournament-comparison-container">
        <!-- Selector Card -->
        <div class="tournament-selector-wrapper">
            <div class="selector-card-inner">
                <div class="selector-label-wrapper">
                    <label for="tournamentSelectorAnalysis" class="tournament-selector-label">
                        <span class="label-icon">üèÜ</span>
                        <span class="label-text">Selecciona un Torneo</span>
                    </label>
                </div>
                <select id="tournamentSelectorAnalysis" class="tournament-selector-input">
                    <option value="">-- Elige un torneo para comparar --</option>
                </select>
            </div>
        </div>

        <!-- Estados -->
        <div id="comparisonLoadingAnalysis" class="comparison-state-box" style="display: none;">
            <div class="state-spinner"></div>
            <p class="state-text">Analizando datos hist√≥ricos...</p>
        </div>

        <div id="comparisonEmptyAnalysis" class="comparison-state-box">
            <div class="state-icon">üèÜ</div>
            <h3 class="state-title">Elige un torneo</h3>
            <p class="state-text">Selecciona un torneo del men√∫ para ver su an√°lisis hist√≥rico</p>
        </div>

        <div id="comparisonNoDataAnalysis" class="comparison-state-box" style="display: none;">
            <div class="state-icon">üìÖ</div>
            <h3 class="state-title">Datos insuficientes</h3>
            <p class="state-text">Este torneo solo tiene una edici√≥n. Se necesitan al menos 2 a√±os para comparar.</p>
        </div>

        <!-- Contenido Principal -->
        <div id="comparisonContentAnalysis" class="comparison-main-content" style="display: none;">
            <!-- Chart Full Width -->
            <div class="tournament-chart-full">
                <div class="tournament-chart-box">
                    <div class="chart-box-header">
                        <h3 class="chart-box-title">üìà Evoluci√≥n de tu Posici√≥n</h3>
                        <p class="chart-box-subtitle">Tendencia a√±o tras a√±o</p>
                    </div>
                    <div class="chart-box-canvas">
                        <canvas id="positionEvolutionChartAnalysis"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Table -->
            <div class="tournament-table-box">
                <div class="table-box-header">
                    <h3 class="table-box-title">üìã Historial Detallado por A√±o</h3>
                </div>
                <div class="table-box-content">
                    <div class="table-scroll-wrapper">
                        <table class="tournament-detail-table">
                            <thead>
                                <tr>
                                    <th class="col-year">A√±o</th>
                                    <th class="col-position">Posici√≥n</th>
                                    <th class="col-players">Jugadores</th>
                                    <th class="col-modality">Modalidad</th>
                                    <th class="col-prize">Premio</th>
                                    <th class="col-notes">Notas</th>
                                </tr>
                            </thead>
                            <tbody id="comparisonTableBodyAnalysis">
                                <!-- Filled by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



	 
		
<!-- Indicador de sincronizaci√≥n -->
    <div id="syncIndicator" style="position: fixed; bottom: 20px; right: 20px; padding: 12px 20px; background: #34c759; color: white; border-radius: 12px; font-weight: 600; opacity: 0; transition: opacity 0.3s; pointer-events: none; z-index: 1000;">
        ‚òÅÔ∏è Sincronizado
    </div>

    <!-- JavaScript -->
	 <script src="js/cloud-sync.js"></script>
    <script src="js/common.js"></script>
    <script src="js/tournaments.js"></script>
	 <script src="js/bottom-nav.js"></script>
	 <script src="js/top-nav.js"></script>
	 <script src="js/tournament-comparison-analisis.js"></script>
	 	 <script src="js/comparativas.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Tu c√≥digo actual...
        
        initTournamentComparisonAnalysis(); // ‚Üê A√ëADE ESTO
    });
</script>
</body>
</html>








