<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estadísticas - Pool Tracker</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    
    <!-- Fuentes -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Librerías externas -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/styles-common.css">
    <link rel="stylesheet" href="../css/styles-estadisticas.css">
    
    <!-- Verificar sesión -->
    <script>
        if (!sessionStorage.getItem('xisco_session_active')) {
            window.location.href = 'index.html';
        }
    </script>
</head>
<body>
    <!-- Header con Logo y Menú -->
    <div class="top-header">
        <div class="header-content">
            <a href="registro-partidos.html" class="logo">
                <div class="logo-icon">
                    <img src="logo.svg" alt="Pool Tracker">
                </div>
                <span class="logo-text">Pool Tracker</span>
            </a>
            
            <nav class="desktop-nav">
                <a href="registro-partidos.html" class="nav-link">Registro</a>
                <a href="estadisticas.html" class="nav-link active">Estadísticas</a>
                <a href="#historial" class="nav-link">Historial</a>
                <a href="config-github.html" class="nav-link">Sincronización</a>
                <a href="#" class="nav-link danger" onclick="resetAllDataDashboard(); return false;">Reiniciar</a>
                <a href="#" class="nav-link" onclick="logout(); return false;">Salir</a>
            </nav>

            <div class="hamburger" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </div>

    <!-- Overlay del menú móvil -->
    <div class="mobile-menu-overlay"></div>

    <!-- Menú lateral móvil -->
    <div class="mobile-menu">
        <nav class="mobile-nav">
            <a href="registro-partidos.html" class="nav-link">Registro</a>
            <a href="estadisticas.html" class="nav-link active">Estadísticas</a>
            <a href="#historial" class="nav-link">Historial</a>
            <a href="config-github.html" class="nav-link">Configuración</a>
            <a href="#" class="nav-link danger" onclick="resetAllDataDashboard(); return false;">Reiniciar Datos</a>
            <a href="#" class="nav-link" onclick="logout(); return false;">Cerrar Sesión</a>
        </nav>
    </div>

    <div class="container">
        <header>
            <h1>Estadísticas</h1>
            <p class="subtitle">Análisis de rendimiento deportivo</p>
        </header>

        <!-- Loading -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Cargando datos...</p>
        </div>

        <!-- Error -->
        <div id="error" style="display: none;"></div>

        <!-- File Upload Section -->
        <div id="fileUploadSection" style="display: none;">
            <div class="chart-card" style="max-width: 600px; margin: 40px auto; text-align: center;">
                <h2 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 16px;">
                    Cargar datos
                </h2>
                <p style="color: #86868b; margin-bottom: 24px;">
                    No se encontraron datos en el servidor. Elige una opción:
                </p>
                <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap;">
                    <button onclick="loadFromRegistration()" class="btn btn-primary">
                        Ir a Registro
                    </button>
                    <label for="jsonFileInput" class="btn btn-secondary">
                        Subir JSON
                    </label>
                    <input type="file" id="jsonFileInput" accept=".json" style="display: none;">
                    <button onclick="loadDemoData()" class="btn btn-secondary">
                        Cargar Demo
                    </button>
                </div>
            </div>
        </div>

        <!-- Content -->
        <div id="content" style="display: none;">
            <!-- Stats Grid -->
            <div class="stats-grid" id="statsGrid"></div>
            
            <!-- Charts Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Análisis visual</h2>
                    <p class="section-description">Gráficos interactivos de rendimiento</p>
                </div>
                <div class="charts-grid" id="chartsGrid"></div>
            </div>

            <!-- Comparison Section -->
            <div class="section" id="comparisonSection" style="display: none;">
                <div class="section-header">
                    <h2 class="section-title">Comparativa de jugadores</h2>
                    <p class="section-description">Análisis cara a cara de rendimiento</p>
                </div>
                <div class="chart-card">
                    <div class="player-selector">
                        <div class="player-select-wrapper">
                            <label class="player-select-label">Xisco</label>
                            <select id="player1Select"></select>
                        </div>
                        <div class="vs-divider">VS</div>
                        <div class="player-select-wrapper">
                            <label class="player-select-label">Rival</label>
                            <select id="player2Select"></select>
                        </div>
                    </div>
                    <div id="comparisonContent"></div>
                </div>
            </div>

            <!-- History Section -->
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title" id="historial">Historial</h2>
                    <p class="section-description">Registro completo de partidos</p>
                </div>
                
                <div id="paginationTopStats" class="pagination-container-stats" style="display: none;"></div>
                
                <div class="chart-card full-width">
                    <div class="table-container">
                        <table class="matches-table" id="matchesTable"></table>
                    </div>
                </div>
                
                <div id="paginationBottomStats" class="pagination-container-stats" style="display: none;"></div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/common.js"></script>
    <script src="../js/estadisticas.js"></script>
</body>
</html>
